<!doctype html>
<html>
  <head>
    <title>Twirl Cube Image Carousel</title>
    <style>
      :root {
        --cube-w: 40vmin;
        --cube-h: calc(var(--cube-w) / 8);
        --side-z: calc(var(--cube-w) / 2);
        --perspective: calc(var(--cube-w) * 1.5);
        --duration: 1600ms;
        --ease: cubic-bezier(0.55, 0.055, 0.675, 0.19);
      }

      html,
      body {
        height: 100%;
        margin: 0;
      }

      body {
        display: grid;
        place-items: center;
        overflow: hidden;
        background-color: #c1b809;
      }

      .container {
        display: flex;
        flex-direction: column-reverse;
        position: relative;
        perspective: var(--perspective);
      }

      .cube {
        position: relative;
        width: var(--cube-w);
        height: var(--cube-h);
        transform-style: preserve-3d;
      }

      .cube.animate {
        animation: cube-rotation var(--duration) var(--ease);
      }

      .side {
        position: absolute;
        width: var(--cube-w);
        height: var(--cube-h);
        background-size: 100% 800%;
        background-position-y: calc((6 - var(--index)) * -100%);
      }

      .front {
        transform: translateZ(var(--side-z));
      }

      .back {
        transform: rotateY(180deg) translateZ(var(--side-z));
      }

      .right {
        transform: rotateY(90deg) translateZ(var(--side-z));
      }

      .left {
        transform: rotateY(-90deg) translateZ(var(--side-z));
      }

      .top,
      .bottom {
        height: var(--cube-w);
        background-color: rgba(0, 0, 0, 0.3);
      }

      .top {
        transform: rotateX(90deg) translateZ(var(--side-z));
      }

      .bottom {
        transform: rotateX(-90deg) translateZ(calc(var(--cube-h) * -3));
      }

      #nextBtn {
        position: fixed;
        bottom: 20px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
      }

      @keyframes cube-rotation {
        60%,
        100% {
          transform: rotateY(0.5turn);
        }
      }

      .cube:nth-child(1) {
        z-index: 1;
      }
      .cube:nth-child(2) {
        z-index: 2;
      }
      .cube:nth-child(3) {
        z-index: 3;
      }
      .cube:nth-child(4) {
        z-index: 4;
      }
      .cube:nth-child(5) {
        z-index: 3;
      }
      .cube:nth-child(6) {
        z-index: 2;
      }
      .cube:nth-child(7) {
        z-index: 1;
      }
    </style>
  </head>
  <body>
    <div class="container" id="cubeContainer"></div>
    <button id="nextBtn">Next</button>

    <script>
      function createCube(index) {
        const cube = document.createElement('div')
        cube.className = 'cube'
        cube.style.setProperty('--index', index)

        const sides = ['front', 'back', 'right', 'left', 'top', 'bottom']
        sides.forEach((side) => {
          const sideDiv = document.createElement('div')
          sideDiv.className = `side ${side}`
          cube.appendChild(sideDiv)
        })

        return cube
      }

      const container = document.getElementById('cubeContainer')
      for (let i = 0; i < 7; i++) {
        container.appendChild(createCube(i))
      }

      let currentImage = 1
      const totalImages = 3

      function updateImages() {
        const sides = document.querySelectorAll('.front, .back, .right, .left')
        sides.forEach((side) => {
          side.style.backgroundImage = `url(public/slide_${currentImage}.jpeg)`
        })
      }

      updateImages()

      document.getElementById('nextBtn').addEventListener('click', () => {
        currentImage = (currentImage % totalImages) + 1

        const cubes = document.querySelectorAll('.cube')
        cubes.forEach((cube, index) => {
          cube.classList.remove('animate')
          void cube.offsetWidth
          cube.classList.add('animate')
          cube.style.animationDelay = `${index * 0.075}s`
        })

        setTimeout(() => {
          updateImages()
        }, 800)
      })
    </script>
  </body>
</html>
